<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Digital Library</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<h1>My Digital Library</h1>

<!-- Top Navigation -->
<nav class="top-nav">
  <a href="{{ url_for('add_author') }}">â• Add Author</a> |
  <a href="{{ url_for('add_book') }}">ğŸ“˜ Add Book</a>
</nav>

<button id="theme-toggle">ğŸŒ™ Dark mode</button>

<!-- Flash Messages -->
{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul class="flash-messages">
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

<!-- Search -->
<form method="GET">
  <input type="text" name="q" placeholder="Search by title or author"
         value="{{ request.args.get('q','') }}">
  <button type="submit">Search</button>
</form>

<!-- Sorting -->
<p>
  Sort by:
  <a href="/?sort=title">Title</a> |
  <a href="/?sort=author">Author</a>
</p>

<!-- Books -->
{% for book in books %}
  <div class="book">
    <img src="https://covers.openlibrary.org/b/isbn/{{ book.isbn }}-M.jpg"
         alt="Cover" height="150"><br>

    <strong>{{ book.title }}</strong><br>
    Author: {{ book.author.name }}<br>
    Year: {{ book.publication_year }}<br>
    ISBN: {{ book.isbn }}<br>

    <form action="{{ url_for('delete_book', book_id=book.id) }}"
          method="POST">
      <button type="submit"
              onclick="return confirm('Delete this book?')">
        Delete
      </button>
    </form>
  </div>
{% else %}
  <p>No books found.</p>
{% endfor %}

<script>
  const toggleBtn = document.getElementById("theme-toggle");
  const savedTheme = localStorage.getItem("theme");

  if (savedTheme === "dark") {
    document.documentElement.setAttribute("data-theme", "dark");
    toggleBtn.textContent = "â˜€ï¸ Light mode";
  }

  toggleBtn.addEventListener("click", () => {
    const dark = document.documentElement.getAttribute("data-theme") === "dark";
    if (dark) {
      document.documentElement.removeAttribute("data-theme");
      localStorage.setItem("theme", "light");
      toggleBtn.textContent = "ğŸŒ™ Dark mode";
    } else {
      document.documentElement.setAttribute("data-theme", "dark");
      localStorage.setItem("theme", "dark");
      toggleBtn.textContent = "â˜€ï¸ Light mode";
    }
  });
</script>

</body>
</html>
xxx